#!/bin/bash



tests=(	"0+#-' "       			"01111110-1E"
		""						"00000000-1E"
		"*"						"10000000-1E"
		"*d"					"10000000-1d"
        "h"						"00000000-1hE"
        "hz"					"00000000-1hE"
        "5%"					"00000005-1%"
        ".0%"					"000000000%"
		" "						"00000010-1E"
		"#0 ##" 				"01010010-1E"
		"0+-ri" 				"01101000-1E"	
		"0+-10.10" 				"01101001010E"
		"0+-0102n.10" 			"0110100102-1E"
		"0+-*01.2d" 			"111010012d"
		"0+-010.10D" 			"01101001010D"
		"0+-010.1060osdfgx" 	"0110100101060o"
		"0+-0q" 				"01101000-1E"
		"0+-010hhd" 			"011010010-1hhd"
		"0+-0.23qdhhq" 			"0110100023E"
		"0+-0.23dh" 			"0110100023d"
        "0+-0.23j" 				"0110100023jE"
        "0+-0.23z" 				"0110100023zE"
        "0+-0.23jjz" 			"0110100023jE"
        "0+-0.23jx" 			"0110100023jx"
        "0#.x"					"010100000x"
        ".2s" 					"000000002s"
      )

function cmp
{
    echo -n `tput setaf 7`
    diff <(eval $1) <(echo -n $2)
    if [ $? == 1 ]; then
		echo `tput setaf 6`KO
    else
		echo `tput setaf 2`OK
    fi
    echo  $3
}

for i in $(seq 0 2 $((${#tests[@]} - 1))); do
    cmp "../parser \"${tests[$i]}\"" ${tests[$(($i + 1))]} ${tests[$i]}
done

