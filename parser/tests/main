#!/bin/bash

tests=(	"0+#-' "       		"11111100"
        "5%"			"00000050%"
        ".0%"			"00000000%"
	" "			"00000100"
	"#0 ##" 		"10100100"
	"0+-ri" 		"11010000"	
	"0+-10.10" 		"1101001010"
	"0+-0102n.10" 		"1101001020"
	"0+-01.2d" 		"11010012d"
	"0+-010.10D" 		"1101001010D"
	"0+-010.1060osdfgx" 	"110100101060o"
	"0+-0q" 		"11010000"
	"0+-010hhd" 		"110100100hhd"
	"0+-0.23qdhhq" 		"110100023"
	"0+-0.23dh" 		"110100023d"
        "0+-0.23j" 		"110100023j"
        "0+-0.23z" 		"110100023z"
        "0+-0.23jjz" 		"110100023j"
      )

function cmp
{
    echo `tput setaf 7`
    diff <(eval $1) <(echo -n $2)
    if [ $? == 1 ]; then
	echo `tput setaf 9` KO
    else
	echo `tput setaf 2` OK
    fi
    echo  $3
}

for i in $(seq 0 2 $((${#tests[@]} - 1))); do
    cmp "../parser \"${tests[$i]}\"" ${tests[$(($i + 1))]} ${tests[$i]}
done

